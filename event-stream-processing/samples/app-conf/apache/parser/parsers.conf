# Apache access
# 
[PARSER]
    name          regex-apache-access
    Format        regex
    Regex         ^(?<labels_format>v1\.0) (?<apache_version>[^ ]+) "(?<url_scheme>[^:]+):\/\/(?<url_domain>[^:]+):(?<url_port>\d+)" "(?<client_ip>[^"]+)" \[(?<apache_access_time>[^\]]+)\] "(?<http_request_line>([^"]|(?<=\\)")*)" (?<http_response_status_code>(-?|\d+)) (?<http_request_bytes>(-?|\d+)) bytes (?<http_response_bytes>(-?|\d+)) bytes "(?<http_request_referrer_original>([^"]|(?<=\\)")*)" "(?<user_agent_original>([^"]|(?<=\\)")*)" (?<event_duration>\d+) ms, "(?<tls_version_protocol>[^"]+)" "(?<tls_cypher>[^"]+)"$?|^(?<source_ip>[^ ]+) ([^ ]+) (?<user_name>[^ ]+) \[(?<apache_access_time>[^\]]+)\] "(?<http_request_line>([^"]|(?<=\\)")*)" (?<http_response_status_code>(-?|\d+)) (?<http_response_bytes>(-?|\d+)) "(?<http_request_referrer_original>([^"]|(?<=\\)")*)" "(?<user_agent_original>([^"]|(?<=\\)")*)" (?<event_duration>(-?|\d+))$|^(?<source_ip>[^ ]+) ([^ ]+) (?<user_name>[^ ]+) \[(?<apache_access_time>[^\]]+)\] "(?<http_request_line>([^"]|(?<=\\)")*)" (?<http_response_status_code>(-?|\d+)) (?<http_response_bytes>(-?|\d+)) "(?<http_request_referrer_original>([^"]|(?<=\\)")*)" "(?<user_agent_original>([^"]|(?<=\\)")*)"$
    Time_Key      apache_access_time
